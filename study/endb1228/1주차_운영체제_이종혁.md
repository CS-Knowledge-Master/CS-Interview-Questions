# 운영체제

---

## 프로세스와 스레드의 차이를 설명해보세요.

### 알고 있었던 내용

프로그램을 실행하면 대응되는 프로세스가 생성된다.  
각 프로세스에서는 하나 이상의 스레드가 생성된다.

---

### 조사한 내용

프로그램을 실행하면 운영체제는 해당 프로그램에 대응되는 프로세스를 생성하고 VAS (Virtual Address Space, 가상 주소 공간)이라는 자원을 할당한다.  
각각의 프로세스 내에서는 하나 이상의 스레드를 생성하며, 각각의 스레드는 프로세스로부터 자원을 할당받는다.

가상 주소 공간은  [ 코드 / 데이터 / 스택 / 힙 ] 영역이 있다.
- 코드 영역: 사용자가 작성한 코드가 기계어의 형태로 저장.
- 데이터 영역: static 영역이라고도 하며, 전역/정적 변수들을 저장.
- 스택 영역: 매개변수, 로컬변수 등 특정 함수를 벗어나면 소멸하는 변수들을 저장.
- 힙 영역: 사용자가 직접 관리하는 동적 변수를 저장.

각각의 스레드는 프로세스의 메모리의 [ 코드 / 데이터 / 스택 / 힙 ] 영역 중 [ 코드 / 데이터 / 힙 ] 영역을 공유한다.
따라서 컨텍스트 스위칭의 경우 프로세스와는 다르게 스레드는 스택 영역을 제외한 나머지 영역을 덮어씌울 필요가 없다.  
대신 스레드는 서로 공유하는 영역들이 있으므로, 동시에 같은 값에 접근할 경우 의도치 않은 결과를 일으킬 수 있다.

---

### 면접 답변용 정리

프로그램을 실행하면 운영체제는 해당 프로그램에 대한 프로세스를 생성하며, 가상 주소 공간이라는 자원을 할당한다.  
가상 주소 공간에는 [ 코드 / 데이터 / 스택 / 힙 ] 영역이 존재한다.  

프로세스가 생성되면 하나 이상의 스레드가 생성되고, 각각의 스레드는 프로세스로부터 자원을 할당받는다.  
프로세스의 가상 주소 공간 중 스택 영역은 스레드마다 할당받으며, 나머지 영역은 모든 스레드가 공유한다.
프로세스는 각각의 프로그램마다 별개의 VAS를 가지므로 의도하지 않는 한 서로 다른 프로세스들끼리 간섭을 일으키는 경우가 거의 없다.    
스레드는 스택 영역을 제외한 나머지 영역을 공유하므로, 여러 스레드가 동시에 같은 변수에 접근할 경우 의도치 않은 결과를 일으킬 수 있다.

프로세스 컨텍스트 스위칭과는 다르게 스레드 컨텍스트 스위칭은 스택 영역을 제외한 나머지 영역을 덮어씌울 필요가 없으므로, 자원도 적게 소모하고 빠르다.

---

### 꼬리 질문
1. 가상 주소 공간의 4가지 영역 [ 코드 / 데이터 / 스택 / 힙 ] 영역에 대해
   - 코드 영역: 사용자가 작성한 코드가 기계어의 형태로 저장.
   - 데이터 영역: static 영역이라고도 하며, 전역/정적 변수들을 저장.
   - 스택 영역: 매개변수, 로컬변수 등 특정 함수를 벗어나면 소멸하는 변수들을 저장.
   - 힙 영역: 사용자가 직접 관리하는 동적 변수를 저장

2. 컨텍스트 스위칭에 대해  
단일 프로세서는 동시에 한 가지 프로세스만을 실행할 수 있다.  
따라서 여러 개의 프로세스를 실행하기 위해서는 계속해서 프로세스를 전환하는 작업이 필요한데, 이를 컨텍스트 스위칭이라고 부른다.  

3. 서로 다른 프로세스 간의 자원 공유는 불가능한가?  
프로세스 간에 자원을 공유하는 것을 IPC (Inter-Process Communication)라고 한다.  
IPC에는 다음과 같은 방법들이 있다.
   - 공유 메모리: 프로세스에서 커널에 요청하여 해당 프로세스 내에 public한 메모리 공간을 할당한다. 해당 공간에는 다른 프로세스에서 접근이 가능하다.
   - 파이프: 한쪽 프로세스는 read, 다른 프로세스는 write하여 FIFO 통신. 일반적으로 파일 시스템을 사용한다.
   - 소켓: 각 프로세스에서 포트를 지정하고, 임의의 프로토콜을 통해 통신.
   - 메시지 큐: key-value의 형태로 메시지를 저장하고, 다른 프로세스에서 key를 이용하여 원하는 데이터를 찾는 방식.

