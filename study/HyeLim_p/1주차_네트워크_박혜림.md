# 네트워크
## 웹 통신의 큰 흐름: https://www.google.com/ 을 접속할 때 일어나는 일

>1. 브라우저를 열어 주소창에 https://www.google.com/ 를 입력한다.
>2. 도메인 네임에 해당하는 IP 주소를 알아야하기에 DNS 에 도메인을 검색하기 위한 요청을 보낸다.
>3. 받은 ip 주소를 사용해 TCP 통신을 통해 해당 ip 서버에 요청을 보낸다.
>4. 요청을 받은 서버(https://www.google.com/) 요청 내용에 대한 일련의 처리 과정을 거쳐 응답 메시지를 만든다.
>5. 응답 메시지를 TCP 통신을 통해 다시 클라이언트에게 전송한다.
>6. 브라우저는 받은 응답 메시지를 HTTP 프로토콜을 사용해 웹 페이지를 구성해 사용자에게 요청한 결과를 보여준다.


1. 도메인 네임 조회

해당 도메인에 대한 주소가 있는지 검사하는 것
DNS 서버에 질의 전 브라우저의 DNS 캐시 확인에 도메인에 대한 정보가 있는지 확인한다.
해당 캐시가 존재하지 않으면 로컬의 hosts 파일에 도메인에 대한 정보가 있는지 확인한다.
해당 정보도 없으면 아래의 라우팅 과정을 거쳐 DNS 서버에 질의를 해야한다.
2. 라우팅

대부분의 가정 집에서는 DHCP(Dynamic Host Configuration Protocol) 로 인터넷에 접속한다.
DHCP는 호스트의 IP 주소 및 TCP/IP 설정을 클라이언트에 자동으로 제공해주는 프로토콜이다.
사용자들은 DHCP 에 자신의 시스템을 위한 IP 주소를 요청하고 IP 를 부여 받으면 다른 호스트와 TCP/IP 를 사용해서 통신을 하게 된다.
이 때 추가로 가장 가까운 라우터의 IP 주소, 가장 가까운 DNS 서버의 IP 주소를 전달받는다
해당 IP 주소를 ARP 프로토콜을 이용해 MAC 주소를 구하면 된다. 

3. DNS 에 도메인 정보 질의
>### DNS(Domain Name System)
>도메인 이름을 IP 주소로 변환해 최종적으로 해당 IP 주소에 접근할 수 있게 하는 시스템이다.
>#### 동작 과정
>0. 캐시를 확인해서 정보가 없으면 아래의 과정을 진행한다.
>1. 사용자가 브라우저에 example.com 을 입력하면 DNS Resolver(ISP) 로 쿼리가 보내진다.
>2. DNS Resolver 가 루트 서버에 쿼리를 보낸다.
>3. 루트 서버는 도메인에 대한 정보를 저장하는 TLD Server 의 주소로 응답한다.
>4. DNS Resolver 기 TLD Server 에 쿼리를 보낸다.
>5. TLD Server 가 example.com (Authoritative nameserver) 의 IP 주소로 응답한다.
>6. DNS Resolver 가 example.com 에 쿼리를 보낸다.
>7. example.com 의 IP 주소가 DNS Resolver 에게 반환된다.
>8. DNS Resolver 가 웹 브라우저에게 example.com 의 IP 주소를 반환한다.
>9. 웹 브라우저가 IP 주소로 HTTP 요청을 보낸다.
>10. 해당 IP 의 서버가 웹 브라우저에 렌더링할 웹 페이지를 반환한다.




4. TCP 커넥션

실제 https://www.google.com/ 와 통신하기 위해 TCP 커넥션을 맺는다.
이 때 3-way handshake 가 사용된다.
> #### 3-way handshake
> TCP/IP 프로토콜을 이용해 통신을 하는 응용 프로그램이 데이터를 전송하기 전에 먼저 정확한 전송을 보장하기 위해 상대방 컴퓨터와 사전에 세션을 수립하는 과정
5. HTTP 요청

TCP 커넥션이 성공하면 연결된 TCP 커넥션 소켓으로 HTTP Request 를 보낸다.
6. 컨텐츠 다운로드

캐시가 존재하면 해당 캐시를 통해 리소스를 가져오고 아니라면, 필요한 파일을 다운로드한다.
7. 브라우저 렌더링

브라우저 렌더링을 통해 사용자에게 뷰가 보여지고 TCP 연결이 종료된다.
이 때 4-way handshake 가 사용된다.
> 4-way handshake
> 세션을 종료하기 위해 수행되는 절차


