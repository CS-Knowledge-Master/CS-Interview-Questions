# TCP와 UDP의 차이점에 대해 설명해보세요.

## 답변

```
TCP와 UDP의 차이점은 전송 데이터의 신뢰성의 차이라고 생각합니다. 
TCP는 연결 지향 방식이라서 호스트간 연결을 형성하고 데이터를 주고 받습니다. 
하지만 UDP의 경우는 비 연결형이기에 수신자의 수신여부를 확인하지 않고 데이터를 전송합니다.
```

### 예상 꼬리질문 및 답변

- TCP가 연결방식이라고 했는데 호스트간 연결을 형성하는 과정에 대해 설명하시오
  ```
  TCP는 3-Way-handshaking이라는 연결 방식으로 호스트간 연결을 형성합니다.
  우선 클라이언트가 연결하려고 하는 서버에서 SYN 패킷을 전송합니다. 이후 클라이언트는 SYN_SENT 상태로 바뀌게 됩니다.
  서버는 클라이언트가 보낸 SYN 패킷을 받고 클라이언트에게 ACK과 SYN flag가 설정된 패킷을 보내게 됩니다. 이때 서버는 SYN_RECEIVED 상태가 됩니다.
  다시 클라이언트는 이 패킷을 받고 서버에게 ACK을 보내게 됩니다.
  이후 서버가 이 패킷을 받게되면 최종적으로 클라이언트와 서버간의 연결이 형성된것입니다.
  ```
    - 패킷에 대해 설명해주세요
  ```
  패킷이라는 것은 출발지와 목적지간의 라우팅되는 데이터의 단위로, 간단하게 데이터의 조각이라고 말할수 있을것 같습니다. 
  앞서 말씀드린 답변에서의 패킷은 TCP 헤더를 포함한 패킷이라고 볼수 있습니다.
  ```
    - SYN flag라는게 뭐를 말하는 거죠?
  ```
  TCP 헤더에는 Control bit라는 6bit의 공간이 존재하는데 이 각각의 비트가 현재 패킷이 어떤 내용을 담고있는지 알려주는 플래그 역할을 하게됩니다.
  SYN flag의 경우는 이 Control bit중 한개의 bit를 의미합니다. SYN(000010),ACK(010000)
  ```

## 내용 정리

- TCP(Transmission Control Protocol)   
  전송을 제어하는 프로토콜로 인터넷 상에서 데이터를 메시지의 형태로 보내기 위해 함께 사용되는 프로토콜로 일련의 옥텟(데이터,메시지,세그먼트)를 안정적이고 순서대로 에러없이 교환하도록 해준다.    
  unreliable network에서 `reliable network`를 보장해주는 프로토콜이다.
    - 특징
        - **연결 지향 방식**이기에 호스트간 연결을 설정후 데이터를 주고받는다.
            - `3-Way handshaking`으로 연결하고 4-way handshakin으로 해제한다.
                - 3- Way handshaking   
                  TCP 통신에서 두 호스트를 연결을 형성하는 과정,절차
                    - 절차
                        1.  클라이언트 → 서버 (SYN)      
                            송신자가 TCP Header의 Sequence Number(x)를 임의로 지정하고 SYN flag를 1로 설정하고 보냄
                        2. 서버 → 클라이언트 (SYN + ACK)  
                           서버가 SYN을 받아 클라이언트에게 받았다는 신호로 SYN + ACK 패킷을 보냄
                           ACK Number 필드를 x+1로 지정하고 Sequence Number는 임의로 지정한다.(y) SYN flag와 ACK flag를 1로 표시한다.
                        3. 클라이언트 → 서버 (ACK)   
                           클라이언트는 서버의 응답을 받아 ACK을 서버로 보낸다.   
                           ACK Number 필드를 y+1로 설정.
        - 흐름제어: `데이터 처리 속도`를 조절하여 수신자의 버퍼오버플로우를 방지한다.
            - 처리 조절방법
                - 기본개념: 수신측이 송신측에게 자신의 상태를 계속 알리는것
                - Sliding window   
                  수신측에서 설정한 윈도우의 크기만큼 송신측에서 세그먼트를 전솔살수 있게하여 데이터 흐름을 동적으로 조절하는 기법
                    - 기본적으로 TCP/IP의 모든 호스트는 송신,수신을 위한 Window를 하나씩 가지고 있다. 여기서 3-way handshake를 통해 송신측의 send window의 크기가 수신측의 received window의 크기로 조절된다.
                - 동작 방식
                    - window의 크기에 맞게 바이트를 보내고 송신측의 확인 응답이 오면 빈 공간 만큼을 window를 이동시켜 전송 가능상태로 만듬.
        - 혼잡제어: 네트워크 내의 패킷수가 과도하게 증가하지 않도록 방지한다.
            - 방식
                - 기본개념: 송신측의 송신 데이터의 전송속도를 강제로 줄임.
                - slow start   
                  송신측의 window size를 지수승으로 증가시키는 방식(2배씩 키움)으로 혼잡현상이 발생(패킷손실 감지,ssthresh)하면 사이즈를 1로 돌린다.

                - AIMD(Additive Increase / Multiplicative Decrease)

                  송신측의 window size를 하나씩 증가시키다가 혼잡 현상이 발생하면 반으로 줄여버린다.

                    - 장점
                        - 최종적으로는 모든 호스트가 공평하게 네트워크를 사용하게된다.
                    - 단점
                        - 초기 네트워크의 큰 대역폭을 바로 사용하지 못한다.(1씩 증가하여서)
                        - 혼잡상태 발생 이후 대역폭을 감소시킨다.
                - 대부분 `slow start`와 `AIMD`를 혼합하여 사용한다.
                - TCP Tahoe

                  혼합제어의 초기 정책으로 `빠른 재전송`이 처음 도입된 정책.

                    - 처음에는 slow start 방식으로 윈도우를 증가시키면서 ssthresh 시점 이후에는 AIMD방식을 사용하는 정책.
                        - ssthresh는 TimeOut,3 ACK Duplicated 같이 네트워크의 혼잡상황이 발생한 경우 해당 시점의 윈도우 크기의 절반으로 설정함.
                    - 문제점
                        - 혼잡상황 발생마다 윈도우 크기를 1로 줄이는 것이 비효율
                - TCP Reno

                  TCP Tahoe와 동일하지만 `3 ACK Duplicated`와 `TimeOut`을 구분하여 처리함. `빠른 회복`을 적용한 정책

                    - 3 ACK Duplicated: 윈도우의 크기를 절반으로 줄이고 ssthresh또한 줄어든 윈도우값으로 설정
                    - TimeOut: 윈도우 사이즈를 1로 줄이고, ssthresh는 변경하지 않는다.
                - 네트워크 혼잡 상황
                    - 3 ACK Duplicated

                      송신측이 3번이상 중복된 승인번호를 받은 상황, 특정 시퀀스 이후 데이터를 제대로 처리 못한 상황.

                    - TimeOut

                      송신측이 데이터를 보낸 이후 일정시간동안 응답을 못받은 경우

                - 빠른 재전송

                  수신측에서 패킷을 받을때 먼저 도착해야할 패킷이 아닌 다음 패킷이 와도 ACK 패킷을 보내는 방식. 이때 원래 도착해야할 패킷의 다음번호를 ACK으로 보냄.

                - 빠른 회복

                  혼잡 상황에서 Window size를 1이 아닌 절반으로 줄이고 선형증가 하는 방식.

        - 높은 신뢰성을 보장하기에 UDP보다 속도가 느리다.
        - 전이중(Full-Duplex),점대점(Point to Point) 방식
            - 전이중: 전송이 양방향으로 동시에 일어날수 있다
            - 점대점: 각 연결이 정확히 2개의 종단점을 가지고 있다.
        - 데이터의 순서를 보장한다.
            - 보장 방식: 패킷 내부에 sequence number라는 순서를 의미하는 공간이 있음.
- UDP(User Datagram Protocol)

  사용자 데이터그램 프로토콜로 데이터를 데이터그램 단위로 처리하는 프로토콜
    - 특징
        - **비 연결형 서비스**로 데이터그램 방식을 제공하여서 데이터의 전송순서가 바뀔수 있음
        - 보내고 받는 신호 절차를 거치지 않음 (잘 전달됐는지 확인하지 않음)
        - 신뢰성이 낮음
        - TCP보다 속도가 빠름.
        - N:N 통신이 가능하다