# 트랜잭션에 대해서 설명해주세요.

## 답변
```
트랙잭션이란 데이터베이스의 상태를 변화시키기 위해 수행되는 작업 단위입니다.
트랜잭션의 결과는 반드시 commit 혹은 rollback 둘중 하나여야 합니다.
```

### 예상 꼬리질문 및 답변

- SQL과 트랜잭션의 차이는 무엇인가요>
  ```
  트랜잭션이라는 하나의 작업에 수많은 SQL이 들어가서 이를 개발자가 정한 기준에 따라서 작업을 분리한것을 의미합니다.
  ```
- commit과 rollback에 대해 설명해주세요
  ```
  commit과 rollback은 트랜잭션의 연산으로서 각각 commit은 트랜잭션 작업이 성공적으로 수행되고 갱신까지 완료된것을 의미하고, 
  Rollback은 트랜잭션이 비정상으로 종료되어서 트랜잭션 내의 일부 정상처리된 SQL까지 취소되는 연산입니다.
  정상처리된 SQL까지 돌리는 이유는 트랜잭션의 성질중 하나인 원자성을 지키기 위함입니다.
  ```
  - 트랜잭션의 성질에 대해 설명해주세요
    ```
    트랜잭션의 성질은 4가지로 각각 원자성,일관성,독립성,지속성이 있습니다.
    원자성은 트랜잭션은 모두 반영되거나 반영되지 않아야 한다는 것을 의미합니다.
    일관성은 트랜잭션 처리에 일관성이 있어야한다는것을 의미합니다.
    독립성은 각각의 트랜잭션이 서로의 연산과정에 침범해서는 안된다는것을 의미합니다.
    지속성의 경우는 트랜잭션이 성공했을경우 즉 commit과정이 되었을경우 그 결과는 영구적으로 반환되어야 한다는것을 의미합니다.
    ```
- 트랜잭션을 왜 사용하나요?
  ```
  데이터의 일관성을 유지하고 데이터를 안정적으로 복구하기 위함입니다.
  ```
- 트랜잭션의 단점은 뭐가 있을까요?
  ```
  트랜잭션의 동시성 문제로 인해 락이 발생, 즉 작업을 대기하는 상황이 발생할수 있고 이로 인해 성능이 저하될수 있습니다.
  또한 rollback 과정에서 시간이 소요될수 있습니다.
  ```
  - 락이 발생한다는게 어떤것을 말하는거죠?
    ```
    락이라는것은 트랜잭션 처리의 순차성을 보장하기 위한 방법입니다. 
    즉 작업을 순서대로 처리하기위한 방법인데 락에는 크게 공유락과 베타락이 존재합니다. 
    공유락은 읽는 과정을 의미하고 베타락은 수정 과정을 의미합니다. 
    여기서 베타락의 경우는 해당 과정동안 다른 트랜잭션은 접근하지 못하는 블로킹이 발생하게 됩니다. 
    이러한 과정에서 대기가 발생하고 결과적으로 성능이 떨어질수 있습니다.
    ```
## 내용 정리

- Transaction(트랜잭션)

  데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 단위로 하나의 트랜잭션은 Commit 되거나 Rollback된다.

    - 상태

      SQL을 이용해 데이터베이스에 접근하는것

    - 성질(ACID)
        - Atomicity(원자성)

          트랜잭션이 모두 반영되거나 반영되지 않아야 함.

        - Consistency(일관성)

          트랜잭션 작업처리 결과가 일관성이 있어야함.

        - Isolation(독립성)

          둘 이상의 트랜잭션이 동시에 실행되어도 서로의 연산을 침범하면 안됨.

        - Durability(지속성)

          트랜잭션이 성공되었을경우 결과는 영구적으로 반환되어야 함.

    - 연산
        - Commit

          트랜잭션 작업이 성공적으로 끝나고 이에 대한 갱신 연산이 완료 된것을 관리자에게 알려주는 연산

        - Rollback

          트랜잭션이 비정상적으로 종료되어 일부가 정상 처리되어도 원자성에 의해 모든 연산이 취소되는 연산

          이때의 트랜잭션은 재시작하거나 폐기된다.

    - 상태
        - Active(활동)

          트랜잭션이 실행중인 상태

        - Partially Commited(부분 완료)

          트랜잭션의 마지막 연산까지 마치고 commit 실행 직전 상태

        - Failed(실패)

          오류 발생으로 중단된 상태

        - Commited(완료)

          성공적으로 종료되어 commit 연산 이후 상태

        - Aborted(취소)

          rollback연산을 수행한 상태

    - 주의점

      트랜잭션은 최소의 코드에만 적용하라 → 여러개의 트랜잭션으로 쪼개서 트랜잭션의 범위를 최소화 시켜라.

        - 왜?

          데이터베이스의 커넥션 개수는 제한적인데 만약 각 프로그램이 오랜시간동안 커넥션을 가지고 있다면 커넥션의 개수가 부족해서 프로그램이 대기하는 시간이 발생함.